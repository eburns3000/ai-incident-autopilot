<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Incident Autopilot</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header class="hero">
    <div class="hero-inner">
      <h1>Incident Autopilot</h1>
      <p>AI-Powered Incident Triage & Runbook Routing</p>
      <div class="hero-meta">
        <span class="pill">Demo-safe</span>
        <span class="pill">No login</span>
        <span class="pill">Audit trail + PIR</span>
      </div>
    </div>
  </header>

  <nav class="nav">
    <button class="nav-link active" data-view="home" id="nav-home">Dashboard</button>
    <button class="nav-link" data-view="new" id="nav-new">New Incident</button>
  </nav>

  <main class="container">

    <!-- Dashboard -->
    <section id="home-view" class="view active">
      <div class="row space-between">
        <h2>Recent Incidents</h2>
        <button id="refresh-btn">Refresh</button>
      </div>
      <div id="incidents-list" class="stack"></div>
    </section>

    <!-- New Incident -->
    <section id="new-view" class="view">
      <h2>Create New Incident</h2>
      <form id="new-incident-form" class="card stack">
        <label>
          Title
          <input id="new-title" placeholder="Production API returning 500 errors" required />
        </label>

        <label>
          Description
          <textarea id="new-description" rows="4" placeholder="What's happening? When did it start? What changed?" required></textarea>
        </label>

        <div class="grid2">
          <label>
            Component
            <input id="new-component" placeholder="checkout-api" />
          </label>
          <label>
            Environment
            <select id="new-environment">
              <option value="prod">prod</option>
              <option value="staging">staging</option>
              <option value="dev">dev</option>
            </select>
          </label>
        </div>

        <label>
          Reporter
          <input id="new-reporter" placeholder="test-user" />
        </label>

        <div class="row gap">
          <button type="submit">Create</button>
          <button type="button" id="new-demo-btn">Fill Demo Example</button>
        </div>

        <div class="muted">
          Tip: After creating, open the incident and click <b>Triage</b>.
        </div>
      </form>
    </section>

    <!-- Incident Detail -->
    <section id="detail-view" class="view">
      <button id="back-btn" class="back-btn">← Back</button>
      <h2 id="detail-title"></h2>

      <div class="card stack" id="detail-meta"></div>

      <div class="card stack">
        <h3>Actions</h3>
        <div class="row wrap gap">
          <button id="btn-triage">Run Triage</button>
          <button id="btn-approve">Approve</button>
          <button id="btn-override">Override</button>
          <button id="btn-resolve">Resolve</button>
          <button id="btn-pir">Generate PIR</button>
        </div>
        <div class="muted">
          Approve/Override/Resolve are logged in the audit trail.
        </div>
      </div>

      <div class="card stack" id="triage-card">
        <h3>AI Triage Results</h3>
        <div id="triage-results" class="muted">No triage yet.</div>
      </div>

      <div class="card stack">
        <h3>Recommended Actions</h3>
        <div id="recommended-actions" class="muted">Run triage to see actions.</div>
      </div>

      <div class="card stack">
        <h3>Post-Incident Review (PIR)</h3>
        <div class="row gap">
          <button id="btn-copy-pir">Copy PIR</button>
          <button id="btn-download-pir">Download PIR (.md)</button>
        </div>
        <pre id="pir-preview" class="pre muted">No PIR generated yet.</pre>
      </div>

      <div class="card stack">
        <h3>Audit Trail</h3>
        <div id="audit-timeline" class="muted">No audit entries yet.</div>
      </div>

    </section>

    <footer class="footer muted">
      Demo App – No authentication required
    </footer>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>
